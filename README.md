# subscription-facade

Сервер, который обрабатывает запросы пользователей на подписку/отписку.
Является "фасадом" к mail-server для пользователя:
```
(user) -----------------> (subscription-facade) -----------------------------> (mail-server)
  ^    "subscribe me"             |       ^     POST /mailings/<id>/subscribe      |
  |    "unsubscribe me"           |       |     POST /mailings/<id>/unsubscribe    |
  |                               |       |                                        |
  |-------------------------------|       |----------------------------------------|
      HTML-страница с ответом                                JSON
           для человека
```

## Как запускать

Запустить:
```
$ npm install
```

Затем:
```
$ npm run build
```

В каталоге `templates` скопируйте файлы `*.example` в файлы без `.example` в конце.
Если нужно, измените шаблоны `*.hbs` под себя.

Шаблоны:
- base.hbs - базовый шаблон страницы с оформлением, стилями и, возможно, скриптами.
Содержимое других шаблонов подставляется в base, там, где указан `@partial-block`.
- subscribe.hbs - шаблон для страницы подписки.
- unsubscribe.hbs - шаблон для страницы отписки.

Далее, создайте файл `config.json` в корне проекта и укажите там URL для mail-server.
Также можно указать порт, на котором запускать HTTP-сервер (по умолчанию - 8001) и
ограничить `mailingId` конкретным значением:
```
{
  "backend": "http://192.168.12.34:8000",
  "mailingId": 123,
  "port": 8000
}
```

Можно запускать:
```
$ node dist/index.js
```
